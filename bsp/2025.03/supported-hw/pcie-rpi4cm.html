<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>LAN9662 PCIe NIC / LAN9696 with Raspberry PI 4 CM as external CPU :: Microchip UNG BSP Documentation</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">Microchip UNG BSP Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="bsp" data-version="2025.03">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">BSP Releases</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">ReadMe</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../release-notes/nav.html">Release Notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../getting-started.html">Getting started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../bootloader.html">Bootloader</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Supported HW</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="lan966x.html">LAN966x</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-boot.html">Booting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-tfa.html">SecureBoot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-tfa_ctl.html">TFA_CTL</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-overlays.html">Overlays</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-flexcom.html">FLEXCOM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-usart.html">USART</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-spi.html">SPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-i2c.html">I2C</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-qspi.html">QSPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-mmc.html">MMC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-pinctrl.html">GPIO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-mcan.html">MCAN</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-wdt.html">Watchdog Timer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-aes-sha.html">Crypto HW Accelerators</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-otp.html">OTP Configuration from Linux userspace</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-udphs.html">UDPHS - USB Device</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="sparx5.html">Sparx5</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="sparx5-boot.html">Booting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="lan969x.html">LAN969x</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-boot.html">Booting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-tfa.html">SecureBoot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-verified-boot.html">Verified Boot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-flexcom.html">FLEXCOM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-usart.html">USART</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-spi.html">SPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-i2c.html">I2C</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-qspi.html">QSPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-mmc.html">MMC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-pinctrl.html">GPIO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-sgpio.html">SGPIO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-mcan.html">MCAN</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-wdt.html">Watchdog Timer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-otp.html">OTP Configuration from Linux userspace</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-usb.html">USB Host Device</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="restore-secureboot.html">Restoring SecureBoot Images</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="pcie-rpi4cm.html">PCIe Endpoint with RPI CM4</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="lan966x-spi-host.html">LAN9662 as a SPI host</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../network_overview.html">Network</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tools_overview.html">Tools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../front_ports.html">Front Ports</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tuning_performance.html">Tuning Network Performance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">L2 Bridge</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../bridge_configuration.html">Bridge Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Frame Forwarding</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../forwarding_overview.html">Forwarding Overview</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../frame_meta_data.html">Frame Metadata</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tc/tc-intro.html">TC Introduction</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tc/tc-flower-vcap.html">TC and VCAP</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../vcap_tool.html">VCAP tool</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ingress</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../basic_qos.html">Basic QoS</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-is1.html">Classification (IS0/IS1)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-is2.html">ACL (IS2)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../policing.html">Policing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Egress</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../scheduling.html">Scheduling</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../frame_preemption.html">Frame Preemption</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../shaping.html">Shaping</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-es2.html">Egress ACL (ES2)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-etag.html">Basic VLAN tagging</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-es0.html">Rewriter VLAN tagging (ES0)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../psfp.html">PSFP</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../frer.html">FRER</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../l3_unicast_routing.html">L3 Unicast Routing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Protection switching</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../mrp.html">MRP</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cfm.html">CFM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ptp.html">PTP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../redbox.html">HSR/PRP</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">BSP Releases</span>
    <span class="version">2025.03</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../2025.12/index.html">BSP Releases</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../2025.12/index.html">2025.12</a>
        </li>
        <li class="version">
          <a href="../../2025.09/index.html">2025.09</a>
        </li>
        <li class="version">
          <a href="../../2025.06/index.html">2025.06</a>
        </li>
        <li class="version">
          <a href="../../2025.06-1/index.html">2025.06-1</a>
        </li>
        <li class="version is-current">
          <a href="../index.html">2025.03</a>
        </li>
        <li class="version">
          <a href="../../2024.12/index.html">2024.12</a>
        </li>
        <li class="version">
          <a href="../../2024.09/index.html">2024.09</a>
        </li>
        <li class="version">
          <a href="../../2024.06/index.html">2024.06</a>
        </li>
        <li class="version">
          <a href="../../2024.03/index.html">2024.03</a>
        </li>
        <li class="version">
          <a href="../../2024.03-1/index.html">2024.03-1</a>
        </li>
        <li class="version">
          <a href="../../2023.12/index.html">2023.12</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="#">Older (on AWS)</a>
      <ul class="versions">
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.09-1.html">2023.09-1</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.09.html">2023.09</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.06.html">2023.06</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.03.html">2023.03</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.12.html">2022.12</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.09.html">2022.09</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.06.html">2022.06</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.03.html">2022.03</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2021.12.html">2021.12</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2021.09.html">2021.09</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">BSP Releases</a></li>
    <li>Supported HW</li>
    <li><a href="pcie-rpi4cm.html">PCIe Endpoint with RPI CM4</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">2025.03</button>
  <div class="version-menu">
    <a class="version" href="../../2025.12/supported-hw/pcie-rpi4cm.html">2025.12</a>
    <a class="version" href="../../2025.09/supported-hw/pcie-rpi4cm.html">2025.09</a>
    <a class="version" href="../../2025.06/supported-hw/pcie-rpi4cm.html">2025.06</a>
    <a class="version" href="../../2025.06-1/supported-hw/pcie-rpi4cm.html">2025.06-1</a>
    <a class="version is-current" href="pcie-rpi4cm.html">2025.03</a>
    <a class="version" href="../../2024.12/supported-hw/pcie-rpi4cm.html">2024.12</a>
    <a class="version" href="../../2024.09/supported-hw/pcie-rpi4cm.html">2024.09</a>
    <a class="version" href="../../2024.06/supported-hw/pcie-rpi4cm.html">2024.06</a>
    <a class="version is-missing" href="../../2024.03/index.html">2024.03</a>
    <a class="version is-missing" href="../../2024.03-1/index.html">2024.03-1</a>
    <a class="version is-missing" href="../../2023.12/index.html">2023.12</a>
  </div>
</div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">LAN9662 PCIe NIC / LAN9696 with Raspberry PI 4 CM as external CPU</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This describes how to use the combination of a Raspberry PI 4 Compute Module with the Raspberry PI Compute Module IO
Board and a EVB-LAN9662-NIC or EVB-LAN9696-24port board.</p>
</div>
<div class="paragraph">
<p>The EVB-LAN9662-NIC and EVB-LAN9696-24port boards are pre-configured for PCIe boot mode.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources"><a class="anchor" href="#_resources"></a>Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This configuration uses the Raspberry PI 4 as the host CPU and therefor the device tree used for this setup is the one
for the Raspberry PI, so you will need to consult the Raspberry PI documentation for details about this SoC.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kernel_configuration"><a class="anchor" href="#_kernel_configuration"></a>Kernel Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The configuration used is a very slim version of the standard Raspberry PI 4 configuration.  Only the bare minimum
needed for a network setup has been added, so you will not be able to use e.g. display, mouse and keyboard combo with
this configuration.  Instead you will have to use a serial/USB console to a workstation to monitor and interact with the
system.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_devicetree_configuration"><a class="anchor" href="#_devicetree_configuration"></a>Devicetree Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The system uses the Raspberry PI 4&#8217;s device tree with a addition of a PCIe device node that hosts all the device tree
nodes for the PCIe NICs onboard devices.</p>
</div>
<div class="paragraph">
<p>These childnodes are mapped into the PCIe Controllers Bus Window to allow the PCIe NIC SwitchDev driver to access all
the needed hardware registers via the PCIe Bus.</p>
</div>
<div class="paragraph">
<p>In order to switch between the EVB-LAN9662-NIC and EVB-LAN9696-24port boards, set the pcb variable in the u-boot
environment:</p>
</div>
<div class="paragraph">
<p>EVB-LAN9662-NIC:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">setenv pcb rpi
saveenv</code></pre>
</div>
</div>
<div class="paragraph">
<p>EVB-LAN9696-24port:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">setenv pcb rpi-lan969x
saveenv</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_bsp_raspberry_pi_4_cm_image"><a class="anchor" href="#_using_the_bsp_raspberry_pi_4_cm_image"></a>Using the BSP Raspberry PI 4 CM image</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This assumes that you have a Raspberry PI 4 Compute Module with the accompanying Raspberry PI 4 CM IO Board and a
LAN9662- or LAN9696 PCIe NIC mounted in the PCIe slot on the IO Board.</p>
</div>
<div class="paragraph">
<p>The BSP release file <code>mscc-brsdk-arm64-&lt;version&gt;.tar.gz</code> contains the image file <code>rpi4cm.img</code> that is needed to boot the
system and get the PCIe NIC enabled.</p>
</div>
<div class="paragraph">
<p>When unpacking the release file mentioned above you will find the image file here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">mscc-brsdk-arm64-&lt;version&gt;/arm64-armv8_a-linux-gnu/standalone_rpi/release/rpi4cm.img</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will also find a readme file that explains the image content and the boot process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">mscc-brsdk-arm64-&lt;version&gt;/arm64-armv8_a-linux-gnu/standalone_rpi/release/README.adoc</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next step depends on the type of Raspberry PI 4 CM that you have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If your CM4 has onboard eMMC you need to write the <code>rpi4cm.img</code> image found in the BSP release to the eMMC.</p>
</li>
<li>
<p>If your CM4 has no onboard eMMC you need to write the image to and SDCard and use that to boot your RPI System.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_writing_the_raspberry_pi_4_cm_emmc"><a class="anchor" href="#_writing_the_raspberry_pi_4_cm_emmc"></a>Writing the Raspberry PI 4 CM eMMC</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First mount the CM4 module on the IO board and put a strap on the J2 pinheaders first position to disable eMMC boot.</p>
</div>
<div class="paragraph">
<p>Clone the RPI usbboot repo and build the tool:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">git clone --depth=1 https://github.com/raspberrypi/usbboot
cd usbboot
make</code></pre>
</div>
</div>
<div class="paragraph">
<p>Attach the RPI4 IO board (with the mounted CM) via a nanoUSB cable (to the USB slave port on the IO Board) and start the
USB driver:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">sudo ./rpiboot</code></pre>
</div>
</div>
<div class="paragraph">
<p>Find the new usb device (e.g. /dev/sdX) using <code>lsblk</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">lsblk --output NAME,FSTYPE,LABEL,UUID,PARTUUID,MOUNTPOINT</code></pre>
</div>
</div>
<div class="paragraph">
<p>Write the <code>rpi4cm.img</code> image to the USB device:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">sudo dd if=rpicm4.img of=/dev/sdX bs=8M status=progress oflag=direct</code></pre>
</div>
</div>
<div class="paragraph">
<p>When done you should have two partitions on the device:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">lsblk --output NAME,FSTYPE,LABEL,UUID,PARTUUID,MOUNTPOINT

sdX
├─sdX1 vfat   bootfs  37CA-39EC                            e088fd39-01
└─sdX2 ext4   rootfs  a4af13c6-d165-4cbd-a9f6-c961fef8255d e088fd39-02</code></pre>
</div>
</div>
<div class="paragraph">
<p>Mount the boot device in ~/mnt/boot and edit the config.txt file and create an empty ssh file (to enable the ssh server):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">mkdir -p ~/mnt/boot
sudo mount /dev/sdX1 ~/mnt/boot/
sudo touch ~/mnt/boot/ssh
sudo nvim  ~/mnt/boot/config.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the config.txt file you should add an overlay to enable the USB ports (not the slave USB port) and a uart setting to
enable the serial console via the PIN header, and enable uart support for the second stage bootloader (to get the
logging out):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">dtoverlay=dwc2,dr_mode=host
enable_uart=1
uart_2ndstage=1</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_serial_console"><a class="anchor" href="#_serial_console"></a>Serial Console</h3>
<div class="paragraph">
<p>To use the serial console to the Linux Kernel running on the Raspberry Pi you can attach a serial/USB converted to the
J8 connector on the RPI 4 IO Board.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pin</th>
<th class="tableblock halign-left valign-top">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">J8-6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ground</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">J8-8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPI TX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">J8-10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPI RX</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You should then be able to get to the Linux console and login as root (no password).</p>
</div>
</div>
<div class="sect2">
<h3 id="_normal_boot"><a class="anchor" href="#_normal_boot"></a>Normal Boot</h3>
<div class="paragraph">
<p>Remove the strap on the pinheader and powercycle the Raspberry PI board to start the system.</p>
</div>
<div class="paragraph">
<p>Using the serial console you should be able to login as root and see that you now have a number of available network
interfaces: 1 on the Raspberry PI IO Board and 4 or 29, depending on the EVB.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_writing_the_raspberry_pi_4_cm_sdcard"><a class="anchor" href="#_writing_the_raspberry_pi_4_cm_sdcard"></a>Writing the Raspberry PI 4 CM SDCard</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Insert the SDCard into a card reader slot and locate the new device using e.g. <code>dmesg</code> or <code>lsblk</code> and then write the
image to the new device using <code>dd</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">sudo dd if=rpicm4.img of=/dev/sdX bs=8M status=progress oflag=direct</code></pre>
</div>
</div>
<div class="paragraph">
<p>When done you should have two partitions on the device:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">lsblk --output NAME,FSTYPE,LABEL,UUID,PARTUUID,MOUNTPOINT

sdX
├─sdX1 vfat   bootfs  37CA-39EC                            e088fd39-01
└─sdX2 ext4   rootfs  a4af13c6-d165-4cbd-a9f6-c961fef8255d e088fd39-02</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can now boot the system.  You may want to use a serial/USB console as described in the previous section.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  This page was built using <a href="https://antora.org">Antora</a>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
