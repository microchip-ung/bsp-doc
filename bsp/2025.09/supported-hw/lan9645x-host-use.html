<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Using EVB-LAN96459F with a host board :: Microchip UNG BSP Documentation</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">Microchip UNG BSP Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="bsp" data-version="2025.09">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">BSP Releases</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">ReadMe</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../release-notes/nav.html">Release Notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../getting-started.html">Getting started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../bootloader.html">Bootloader</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Supported HW</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="lan966x.html">LAN966x</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-boot.html">Booting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-tfa.html">SecureBoot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-tfa_ctl.html">TFA_CTL</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-overlays.html">Overlays</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-flexcom.html">FLEXCOM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-usart.html">USART</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-spi.html">SPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-i2c.html">I2C</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-qspi.html">QSPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-mmc.html">MMC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-pinctrl.html">GPIO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-mcan.html">MCAN</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-wdt.html">Watchdog Timer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-aes-sha.html">Crypto HW Accelerators</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-otp.html">OTP Configuration from Linux userspace</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-udphs.html">UDPHS - USB Device</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="sparx5.html">Sparx5</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="sparx5-boot.html">Booting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="sparx5-qusxgmii.html">QUSXGMII</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="lan969x.html">LAN969x</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-boot.html">Booting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-tfa.html">SecureBoot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-verified-boot.html">Verified Boot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-flexcom.html">FLEXCOM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-usart.html">USART</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-spi.html">SPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-i2c.html">I2C</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-qspi.html">QSPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-mmc.html">MMC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-pinctrl.html">GPIO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-sgpio.html">SGPIO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-mcan.html">MCAN</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-wdt.html">Watchdog Timer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-otp.html">OTP Configuration from Linux userspace</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-usb.html">USB Host Device</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="lan9645x.html">LAN9645x</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="lan9645x-host-use.html">Using LAN9645x with a host board</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="create-secureboot.html">Creating SecureBoot Images</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="restore-secureboot.html">Restoring SecureBoot Images</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="secureboot-monitor-mode.html">SecureBoot Monitor Mode</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pcie-rpi4cm.html">PCIe Endpoint with RPI CM4</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="lan966x-spi-host.html">LAN9662 as a SPI host</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../network_overview.html">Network</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tools_overview.html">Tools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../front_ports.html">Front Ports</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tuning_performance.html">Tuning Network Performance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">L2 Bridge</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../bridge_configuration.html">Bridge Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Frame Forwarding</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../forwarding_overview.html">Forwarding Overview</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../frame_meta_data.html">Frame Metadata</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tc/tc-intro.html">TC Introduction</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tc/tc-flower-vcap.html">TC and VCAP</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../vcap_tool.html">VCAP tool</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ingress</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../basic_qos.html">Basic QoS</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-is1.html">Classification (IS0/IS1)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-is2.html">ACL (IS2)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../policing.html">Policing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Egress</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../scheduling.html">Scheduling</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../frame_preemption.html">Frame Preemption</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../shaping.html">Shaping</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-es2.html">Egress ACL (ES2)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-etag.html">Basic VLAN tagging</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-es0.html">Rewriter VLAN tagging (ES0)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../psfp.html">PSFP</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../frer.html">FRER</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../l3_unicast_routing.html">L3 Unicast Routing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Protection switching</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../mrp.html">MRP</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cfm.html">CFM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ptp.html">PTP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../redbox.html">HSR/PRP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../xdp.html">eXpress Data Path (XDP)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../port_security.html">802.1X Port Security</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">BSP Releases</span>
    <span class="version">2025.09</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">BSP Releases</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2025.09</a>
        </li>
        <li class="version">
          <a href="../../2025.06/index.html">2025.06</a>
        </li>
        <li class="version">
          <a href="../../2025.06-1/index.html">2025.06-1</a>
        </li>
        <li class="version">
          <a href="../../2025.03/index.html">2025.03</a>
        </li>
        <li class="version">
          <a href="../../2024.12/index.html">2024.12</a>
        </li>
        <li class="version">
          <a href="../../2024.09/index.html">2024.09</a>
        </li>
        <li class="version">
          <a href="../../2024.06/index.html">2024.06</a>
        </li>
        <li class="version">
          <a href="../../2024.03/index.html">2024.03</a>
        </li>
        <li class="version">
          <a href="../../2024.03-1/index.html">2024.03-1</a>
        </li>
        <li class="version">
          <a href="../../2023.12/index.html">2023.12</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="#">Older (on AWS)</a>
      <ul class="versions">
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.09-1.html">2023.09-1</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.09.html">2023.09</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.06.html">2023.06</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.03.html">2023.03</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.12.html">2022.12</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.09.html">2022.09</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.06.html">2022.06</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.03.html">2022.03</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2021.12.html">2021.12</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2021.09.html">2021.09</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">BSP Releases</a></li>
    <li>Supported HW</li>
    <li><a href="lan9645x.html">LAN9645x</a></li>
    <li><a href="lan9645x-host-use.html">Using LAN9645x with a host board</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">2025.09</button>
  <div class="version-menu">
    <a class="version is-current" href="lan9645x-host-use.html">2025.09</a>
    <a class="version is-missing" href="../../2025.06/index.html">2025.06</a>
    <a class="version is-missing" href="../../2025.06-1/index.html">2025.06-1</a>
    <a class="version is-missing" href="../../2025.03/index.html">2025.03</a>
    <a class="version is-missing" href="../../2024.12/index.html">2024.12</a>
    <a class="version is-missing" href="../../2024.09/index.html">2024.09</a>
    <a class="version is-missing" href="../../2024.06/index.html">2024.06</a>
    <a class="version is-missing" href="../../2024.03/index.html">2024.03</a>
    <a class="version is-missing" href="../../2024.03-1/index.html">2024.03-1</a>
    <a class="version is-missing" href="../../2023.12/index.html">2023.12</a>
  </div>
</div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Using EVB-LAN96459F with a host board</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The EVB-LAN96459F board can currently be used with EVB-LAN9668-EDS2 boards as
the host.</p>
</div>
<div class="paragraph">
<p>This board has the RGMII, SPI and interrupt line that allows the LAN9645x to be
managed via a Linux DSA Driver.</p>
</div>
<div class="paragraph">
<p>When the Linux Kernel runs on the host system the DSA driver uses the SPI
connection to manage the configuration of the switch and the RGMII connection to
inject and extract network frames.  The interrupt line provides events to the
host system.</p>
</div>
<div class="paragraph">
<p>In the console of the host system both the hosts own network ports as well
as the front ports of the LAN9645x will be available as Linux network
interfaces.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_evb_lan9668_eds2_as_host_board"><a class="anchor" href="#_evb_lan9668_eds2_as_host_board"></a>1. EVB-LAN9668-EDS2 as host board</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_getting_the_software"><a class="anchor" href="#_getting_the_software"></a>1.1. Getting the software</h3>
<div class="paragraph">
<p>First obtain the BSP Software release containing the software for the host
system.</p>
</div>
<div class="paragraph">
<p>The file is named like this: "mchp-brsdk-arm-2025.02.3-XXX.tar.gz"</p>
</div>
<div class="paragraph">
<p>where XXX is the number of the build by the Microchip BSP build system.</p>
</div>
<div class="paragraph">
<p>The Linux Kernel for the host will also contain the Linux DSA Driver for the
EVB-LAN96459F, so you only need to select the configuration that contains the
device tree that loads the driver (and its dependencies).</p>
</div>
<div class="paragraph">
<p>The name of the configuration is "lan9668_ung8385_lan9645x_evb_0_at_lan966x"</p>
</div>
<div class="paragraph">
<p>Unpack the tarball and locate and display the contents of the <code>standalone</code>
folder that contains the artifacts that you will need:
file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>tar xvf mchp-brsdk-arm-2025.02.3-*.tar.gz
ls -1  mchp-brsdk-arm-2025.02.3-*/arm-cortex_a8-linux-gnu/standalone/release</pre>
</div>
</div>
<div class="sect3">
<h4 id="_fit_image"><a class="anchor" href="#_fit_image"></a>1.1.1. FIT Image</h4>
<div class="paragraph">
<p>Display the contents of the U-Boot FIT image file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dumpimage -l mchp-brsdk-arm-2025.02.3-*/arm-cortex_a8-linux-gnu/standalone/release/fit.itb</pre>
</div>
</div>
<div class="paragraph">
<p>In this list of Linux kernel, root file system, device trees and configurations
you should be able to see the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Configuration 7 (lan9668_ung8385_lan9645x_evb_0_at_lan966x)
 Description:  Kernel with DT fdt_lan9668_ung8385_lan9645x_evb_0_at_lan966x
 Kernel:       kernel
 Init Ramdisk: ramdisk
 FDT:          fdt_lan9668_ung8385_lan9645x_evb_0_at_lan966x</pre>
</div>
</div>
<div class="paragraph">
<p>This configuration is the one you will be using for network booting the host
system.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ext4_filesystem_image"><a class="anchor" href="#_ext4_filesystem_image"></a>1.1.2. ext4 filesystem image</h4>
<div class="paragraph">
<p>It is also possible to write a complete ext4 filesystem image to the hosts eMMC
device and use that when booting. The ext4 root file system contains a so
called "bare" FIT image that U-Boot can load.</p>
</div>
<div class="paragraph">
<p>The bare FIT image contains a Linux Kernel, device trees and configurations, but
no root file system (as this is the content of the ext4 image).</p>
</div>
<div class="paragraph">
<p>The file is named <code>brsdk_standalone_arm.ext4.gz</code> in the release tarball.</p>
</div>
<div class="paragraph">
<p>Copy the ext4 filesystem image file from the release to the root of your TFTP
server.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_network_boot_the_fit_image_using_u_boot"><a class="anchor" href="#_network_boot_the_fit_image_using_u_boot"></a>1.2. Network boot the FIT image using U-Boot</h3>
<div class="paragraph">
<p>For simplicity we start by network booting the FIT image, which means that you
must provide a TFTP server that holds the <code>fit.itb</code> file that was listed
above.</p>
</div>
<div class="paragraph">
<p>Copy the
<code>mchp-brsdk-arm-2025.02.3-*/arm-cortex_a8-linux-gnu/standalone/release/fit.itb</code>
file to the root of the TFTP server, to make it available for network booting by
the EVB-LAN9668-EDS2, and ensure that the service is visible on the network
where the EVB-LAN9668-EDS2 is connected.</p>
</div>
<div class="paragraph">
<p>Now start by inserting the EVB-LAN96459F in slot 0 (labelled "MUST USE FIRST") of
the EVB-LAN9668-EDS2 board.</p>
</div>
<div class="paragraph">
<p>Attach power, USB Console and network cables to the host board.</p>
</div>
<div class="paragraph">
<p>Start a terminal program and attach to the host board serial/USB connection.
You can now press the reset button on the host and watch the boot sequence of the
host system in your terminal program.</p>
</div>
<div class="paragraph">
<p>Stop the boot at the U-Boot shell by pressing Ctrl+C</p>
</div>
<div class="paragraph">
<p>Enter the following commands to setup network boot of the system:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>setenv net_boot run rootargs_ram \; run setup \; dhcp fit.itb \; bootm \${loadaddr}#lan9668_ung8385_lan9645x_evb_0_at_lan966x
setenv bootcmd run net_boot
saveenv</pre>
</div>
</div>
<div class="paragraph">
<p>If you would like to see the boot log as the kernel boots, you can do an</p>
</div>
<div class="listingblock">
<div class="content">
<pre>editenv bootargs_extra</pre>
</div>
</div>
<div class="paragraph">
<p>and set the loglevel to a high value like e.g. 8.</p>
</div>
<div class="paragraph">
<p>Now you can run the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>reset</pre>
</div>
</div>
<div class="paragraph">
<p>to start the boot process.</p>
</div>
<div class="paragraph">
<p>If all went well you should now be seeing the LAN9645x being detected on the
host system in the boot log:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[    1.617871] microchip-lan9645x-spi spi0.0: SPI frequency: 35000000, padding bytes required: 9
[    1.631791] microchip-lan9645x-spi spi0.0: SPI frequency: 35000000, padding bytes required: 9
...
[    5.667280] lan9645x-switch lan9645x-switch.11.auto: NPI port=7
[    5.673254] lan9645x-switch lan9645x-switch.11.auto: Disabled IPv6 on conduit device: eth2
[    5.683007] lan9645x-switch lan9645x-switch.11.auto: Registered netlink family 'mchp_qos_9645x'
[    5.693652] lan9645x-switch lan9645x-switch.11.auto: Registered netlink family 'mchp_frer_9645x'
...
[    5.764636] lan9645x-switch lan9645x-switch.11.auto: configuring for fixed/rgmii-id link mode
[    5.775323] lan9645x-switch lan9645x-switch.11.auto: Link is Up - 1Gbps/Full - flow control rx/tx
[    5.864211] lan9645x-switch lan9645x-switch.11.auto lan0 (uninitialized): PHY [lan9645x-miim1.6.auto-mii:01] driver [Microchip LAN9645X Gigabit PHY] (irq=51)
[    5.974316] lan9645x-switch lan9645x-switch.11.auto lan1 (uninitialized): PHY [lan9645x-miim1.6.auto-mii:02] driver [Microchip LAN9645X Gigabit PHY] (irq=52)
[    6.074545] lan9645x-switch lan9645x-switch.11.auto lan2 (uninitialized): PHY [lan9645x-miim1.6.auto-mii:03] driver [Microchip LAN9645X Gigabit PHY] (irq=53)
[    6.164300] lan9645x-switch lan9645x-switch.11.auto lan3 (uninitialized): PHY [lan9645x-miim1.6.auto-mii:04] driver [Microchip LAN9645X Gigabit PHY] (irq=54)</pre>
</div>
</div>
<div class="paragraph">
<p>and at the Linux console prompt you can now login as root and verify that the
network interfaces provided by LAN9645x and visible on the host system.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># ip link
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: bond0: &lt;BROADCAST,MULTICAST,MASTER&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 1e:1e:8e:3c:cd:36 brd ff:ff:ff:ff:ff:ff
3: dummy0: &lt;BROADCAST,NOARP&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 96:1f:1d:ed:86:10 brd ff:ff:ff:ff:ff:ff
4: eth0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 52:98:2f:30:cb:9c brd ff:ff:ff:ff:ff:ff
5: eth1: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 52:98:2f:30:cb:9d brd ff:ff:ff:ff:ff:ff
6: eth2: &lt;BROADCAST,MULTICAST&gt; mtu 1544 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 52:98:2f:30:cb:9e brd ff:ff:ff:ff:ff:ff
7: sit0@NONE: &lt;NOARP&gt; mtu 1480 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/sit 0.0.0.0 brd 0.0.0.0
8: lan0@eth2: &lt;BROADCAST,MULTICAST,M-DOWN&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 52:98:2f:30:cb:9e brd ff:ff:ff:ff:ff:ff
9: lan1@eth2: &lt;BROADCAST,MULTICAST,M-DOWN&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 52:98:2f:30:cb:9e brd ff:ff:ff:ff:ff:ff
10: lan2@eth2: &lt;BROADCAST,MULTICAST,M-DOWN&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 52:98:2f:30:cb:9e brd ff:ff:ff:ff:ff:ff
11: lan3@eth2: &lt;BROADCAST,MULTICAST,M-DOWN&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 52:98:2f:30:cb:9e brd ff:ff:ff:ff:ff:ff
12: lan5@eth2: &lt;BROADCAST,MULTICAST,M-DOWN&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 52:98:2f:30:cb:9e brd ff:ff:ff:ff:ff:ff
13: lan6@eth2: &lt;BROADCAST,MULTICAST,M-DOWN&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 52:98:2f:30:cb:9e brd ff:ff:ff:ff:ff:ff</pre>
</div>
</div>
<div class="paragraph">
<p>The ports on the EVB-LAN96459F is made available on the host with the naming
<code>lanX@eth2</code> which signifies that the eth2 port (an RGMII port on the host) is
used as the connection towards the EVB-LAN96459F.  In DSA this is called the
conduit port.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Take care not to use the conduit port (<code>eth2</code>) for any service
configuration as this is supposed to be owned by the Linux DSA Driver.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can now start to configure and use the ports on the EVB-LAN96459F as
described in the <a href="../network_overview.html" class="xref page">network</a> section of this BSP.</p>
</div>
</div>
<div class="sect2">
<h3 id="_emmc_boot"><a class="anchor" href="#_emmc_boot"></a>1.3. eMMC boot</h3>
<div class="paragraph">
<p>Ensure that you are currently booting from the host NOR flash device, as this
will make it possible to return to a functional secure boot environment, in case
something does not work as expected in the ext4 Image.</p>
</div>
<div class="paragraph">
<p>Then check if you can boot from eMMC by changing the
<a href="lan966x-boot.html#pin_modes" class="xref page">bootstrapping</a> on the
EVB-LAN9668-EDS2 board to eMMC and powercycle the board.</p>
</div>
<div class="paragraph">
<p>If you can boot from eMMC, then you can skip to the <a href="#update_ext4_only">Only update the ext4 filesystem</a> section
below.</p>
</div>
<div class="paragraph">
<p>If you cannot boot from eMMC you need follow the procedure in the following
section.</p>
</div>
<div class="paragraph">
<p>Remember to switch back to booting the NOR flash before you continue.</p>
</div>
<div class="sect3">
<h4 id="_boot_from_emmc_from_scratch"><a class="anchor" href="#_boot_from_emmc_from_scratch"></a>1.3.1. Boot from eMMC from scratch</h4>
<div class="paragraph">
<p>To use the eMMC device as the boot media and root file system, you will need to
first create a partition table on the eMMC, if you have not already done so.</p>
</div>
<div class="paragraph">
<p>Then the FIP image (TF-A 2nd stage bootloader) must be added to the 'fip'
partition and optionally the <code>fip.bak</code> partition.</p>
</div>
<div class="paragraph">
<p>Finally you need to write the new root file system (including a bare FIT image)
to the Boot0 partition.</p>
</div>
<div class="paragraph">
<p>Follow the procedure <a href="lan966x-boot.html#emmc_update" class="xref page">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="update_ext4_only"><a class="anchor" href="#update_ext4_only"></a>1.3.2. Only update the ext4 filesystem</h4>
<div class="paragraph">
<p>If you already have a GPT partitioned eMMC device with a working FIP, then you
only need to write the new root file system (including a bare FIT image)
to the <code>Boot0</code> partition.</p>
</div>
<div class="paragraph">
<p>Follow the procedure <a href="lan966x-boot.html#update_ext4" class="xref page">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_set_emmc_as_the_boot_media"><a class="anchor" href="#_set_emmc_as_the_boot_media"></a>1.3.3. Set eMMC as the boot media</h4>
<div class="paragraph">
<p>When you have changed the bootstrapping of the board to use the eMMC device,
U-Boot should automatically use the ext4 filesystem to as the root filesystem
and load the bare FIT image from that location.</p>
</div>
<div class="paragraph">
<p>But you also need to select the correct device tree as mentioned above.</p>
</div>
<div class="paragraph">
<p>In the U-Boot shell change the value of the <code>pcb</code> setting like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>m =&gt; setenv pcb lan9668_ung8385_lan9645x_evb_0_at_lan966x
m =&gt; saveenv</pre>
</div>
</div>
<div class="paragraph">
<p>From now on the LAN9645x device tree will be used by the EVB-LAN9668-EDS2 host
system to load the DSA driver that finds the LAN9645x device.</p>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  This page was built using <a href="https://antora.org">Antora</a>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
