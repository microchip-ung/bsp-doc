<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>LAN966x I2C :: Microchip UNG BSP Documentation</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">Microchip UNG BSP Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="bsp" data-version="2024.09">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">BSP Releases</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">ReadMe</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../release-notes/nav.html">Release Notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../getting-started.html">Getting started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../bootloader.html">Bootloader</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Supported HW</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="lan966x.html">LAN966x</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-boot.html">Booting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-tfa.html">SecureBoot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-tfa_ctl.html">TFA_CTL</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-overlays.html">Overlays</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-flexcom.html">FLEXCOM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-usart.html">USART</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-spi.html">SPI</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="lan966x-i2c.html">I2C</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-qspi.html">QSPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-mmc.html">MMC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-pinctrl.html">GPIO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-mcan.html">MCAN</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-wdt.html">Watchdog Timer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-aes-sha.html">Crypto HW Accelerators</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-otp.html">OTP Configuration from Linux userspace</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan966x-udphs.html">UDPHS - USB Device</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sparx5.html">Sparx5</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="lan969x.html">LAN969x</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-boot.html">Booting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-tfa.html">SecureBoot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-verified-boot.html">Verified Boot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-flexcom.html">FLEXCOM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-usart.html">USART</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-spi.html">SPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-i2c.html">I2C</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-qspi.html">QSPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-mmc.html">MMC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-pinctrl.html">GPIO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-sgpio.html">SGPIO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-mcan.html">MCAN</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-wdt.html">Watchdog Timer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-otp.html">OTP Configuration from Linux userspace</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lan969x-usb.html">USB Host Device</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="restore-secureboot.html">Restoring SecureBoot Images</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pcie-rpi4cm.html">PCIe Endpoint with RPI CM4</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="lan966x-spi-host.html">LAN9662 as a SPI host</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Network</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../network_overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tools_overview.html">Tools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../front_ports.html">Front Ports</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tuning_performance.html">Tuning Network Performance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">L2 Bridge</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../bridge_configuration.html">Bridge Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Frame Forwarding</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../forwarding_overview.html">Forwarding Overview</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../frame_meta_data.html">Frame Metadata</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tc/tc-intro.html">TC Introduction</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tc/tc-flower-vcap.html">TC and VCAP</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../vcap_tool.html">VCAP tool</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ingress</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../basic_qos.html">Basic QoS</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-is1.html">Classification (IS0/IS1)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-is2.html">ACL (IS2)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../policing.html">Policing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Egress</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../scheduling.html">Scheduling</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../frame_preemption.html">Frame Preemption</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../shaping.html">Shaping</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-es2.html">Egress ACL (ES2)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-etag.html">Basic VLAN tagging</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tc/tc-es0.html">Rewriter VLAN tagging (ES0)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../psfp.html">PSFP</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../frer.html">FRER</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../l3_unicast_routing.html">L3 Unicast Routing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Protection switching</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../mrp.html">MRP</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cfm.html">CFM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ptp.html">PTP</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">BSP Releases</span>
    <span class="version">2024.09</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../2025.12/index.html">BSP Releases</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../2025.12/index.html">2025.12</a>
        </li>
        <li class="version">
          <a href="../../2025.09/index.html">2025.09</a>
        </li>
        <li class="version">
          <a href="../../2025.06/index.html">2025.06</a>
        </li>
        <li class="version">
          <a href="../../2025.06-1/index.html">2025.06-1</a>
        </li>
        <li class="version">
          <a href="../../2025.03/index.html">2025.03</a>
        </li>
        <li class="version">
          <a href="../../2024.12/index.html">2024.12</a>
        </li>
        <li class="version is-current">
          <a href="../index.html">2024.09</a>
        </li>
        <li class="version">
          <a href="../../2024.06/index.html">2024.06</a>
        </li>
        <li class="version">
          <a href="../../2024.03/index.html">2024.03</a>
        </li>
        <li class="version">
          <a href="../../2024.03-1/index.html">2024.03-1</a>
        </li>
        <li class="version">
          <a href="../../2023.12/index.html">2023.12</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="#">Older (on AWS)</a>
      <ul class="versions">
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.09-1.html">2023.09-1</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.09.html">2023.09</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.06.html">2023.06</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.03.html">2023.03</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.12.html">2022.12</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.09.html">2022.09</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.06.html">2022.06</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.03.html">2022.03</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2021.12.html">2021.12</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2021.09.html">2021.09</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">BSP Releases</a></li>
    <li>Supported HW</li>
    <li><a href="lan966x.html">LAN966x</a></li>
    <li><a href="lan966x-i2c.html">I2C</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">2024.09</button>
  <div class="version-menu">
    <a class="version" href="../../2025.12/supported-hw/lan966x-i2c.html">2025.12</a>
    <a class="version" href="../../2025.09/supported-hw/lan966x-i2c.html">2025.09</a>
    <a class="version" href="../../2025.06/supported-hw/lan966x-i2c.html">2025.06</a>
    <a class="version" href="../../2025.06-1/supported-hw/lan966x-i2c.html">2025.06-1</a>
    <a class="version" href="../../2025.03/supported-hw/lan966x-i2c.html">2025.03</a>
    <a class="version" href="../../2024.12/supported-hw/lan966x-i2c.html">2024.12</a>
    <a class="version is-current" href="lan966x-i2c.html">2024.09</a>
    <a class="version" href="../../2024.06/supported-hw/lan966x-i2c.html">2024.06</a>
    <a class="version" href="../../2024.03/supported-hw/lan966x-i2c.html">2024.03</a>
    <a class="version" href="../../2024.03-1/supported-hw/lan966x-i2c.html">2024.03-1</a>
    <a class="version" href="../../2023.12/supported-hw/lan966x-i2c.html">2023.12</a>
  </div>
</div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">LAN966x I2C</h1>
<div class="sect1">
<h2 id="_soc_resources"><a class="anchor" href="#_soc_resources"></a>SoC Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>LAN966X SoC have 5 FLEXCOMs (Flexible Serial Communication Controller).
In order to use the Flexcom I2C interface, a specific flexcom instance must be
configured in I2C mode (this is sometimes also called Two-wire interface or TWI)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kernel_configurations"><a class="anchor" href="#_kernel_configurations"></a>Kernel configurations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Following kernel config options should be enabled to use LAN966x I2C interface:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CONFIG_MFD_ATMEL_FLEXCOM</code> - Flexcom driver config option.</p>
</li>
<li>
<p><code>CONFIG_I2C_AT91</code> - I2C driver config option.</p>
</li>
<li>
<p>Corresponding flash driver should be enabled. Below example explains I2C with
a EEPROM device for which <code>CONFIG_EEPROM_AT24</code> config option is required.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_devicetree_configuration"><a class="anchor" href="#_devicetree_configuration"></a>Devicetree Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use I2C interface, following configurations are required in device tree.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each of the flexcom flx0, flx1, flx2, flx3 and flx4 nodes can be configured in
I2C mode <code>ATMEL_FLEXCOM_MODE_TWI</code> to use I2C interface.</p>
</li>
<li>
<p><code>compatible</code> string must be set to <code>microchip,sam9x60-i2c</code>.</p>
</li>
<li>
<p><code>reg</code> property must be set with register address and length as <code>&lt;0x600 0x200&gt;</code></p>
</li>
<li>
<p>GPIO pins for TXD, RXD should be configured to <code>pinctrl-0</code> property.. List of
possible pin mappings are as in below table:</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">FLEXCOM Node</th>
<th class="tableblock halign-left valign-top">DT RXD node</th>
<th class="tableblock halign-left valign-top">RXD pin</th>
<th class="tableblock halign-left valign-top">DT TXD node</th>
<th class="tableblock halign-left valign-top">TXD pin</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc0_a_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc0_a_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc0_b_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO25</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc0_b_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO26</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc0_c_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO62</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc0_c_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO63</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc1_a_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc1_a_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO13</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc1_b_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO34</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc1_b_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO35</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc1_c_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO47</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc1_c_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO48</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc2_a_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc2_a_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc2_b_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO44</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc2_b_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO45</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc3_a_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc3_a_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO19</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc3_b_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO52</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc3_b_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO53</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc3_c_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO31</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc3_c_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc4_a_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc4_a_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO22</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc4_b_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO57</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc4_b_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO58</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc4_c_rxd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO65</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc4_c_txd_pins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO66</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><code>interrupts</code> property must set with interrupt details.
Interrupt lines[CPU INTR] corresponding to a flexcom must be configured as
defined in below table:</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">FLEXCOM ID</th>
<th class="tableblock halign-left valign-top">Shared Peripheral Interrupt</th>
<th class="tableblock halign-left valign-top">CPU INTR</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">48</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">81</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">49</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">82</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">83</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">51</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flx4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">84</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">52</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note that Shared peripheral interrupt lines start at index ID32. So, CPU INTR
must be calculated as [Shared peripheral interrupt number - 32].</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Input clock <code>clocks</code> property must be set to <code>&amp;nic_clk</code>. Note that NIC
clock(200Mhz) is clock used by AXI, AHB fabric and APB bridges which connects
all th peripherals.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_references"><a class="anchor" href="#_references"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.kernel.org/doc/html/latest/driver-api/i2c.html">I2C driver implementation</a></p>
</li>
<li>
<p><a href="https://elixir.bootlin.com/linux/latest/source/Documentation/devicetree/bindings/mfd/atmel,sama5d2-flexcom.yaml">Flexcom DT documentation</a></p>
</li>
<li>
<p><a href="https://elixir.bootlin.com/linux/latest/source/Documentation/devicetree/bindings/i2c/atmel,at91sam-i2c.yaml">I2C DT documentation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_example"><a class="anchor" href="#_example"></a>Example</h3>
<div class="paragraph">
<p>Following example shows how a flexcom I2C should be defined in DT to use
EEPROM device present on it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>flx2: flexcom@e0060000 {
    compatible = "atmel,sama5d2-flexcom";
    reg = &lt;0xe0060000 0x100&gt;;
    clocks = &lt;&amp;clks GCK_ID_FLEXCOM2&gt;;
    #address-cells = &lt;1&gt;;
    #size-cells = &lt;1&gt;;
    ranges = &lt;0x0 0xe0060000 0x800&gt;;
    status = "disabled";

    i2c2: i2c@600 {
        compatible = "microchip,sam9x60-i2c";
        reg = &lt;0x600 0x200&gt;;
        interrupts = &lt;GIC_SPI 50 IRQ_TYPE_LEVEL_HIGH&gt;;
        dmas = &lt;&amp;dma0 AT91_XDMAC_DT_PERID(7)&gt;,
               &lt;&amp;dma0 AT91_XDMAC_DT_PERID(6)&gt;;
        dma-names = "tx", "rx";
        clocks = &lt;&amp;nic_clk&gt;;
        #address-cells = &lt;1&gt;;
        #size-cells = &lt;0&gt;;
        status = "disabled";
    };
};

&amp;gpio {
    fc2_b_pins: fc2-b-pins {
        /* RX, TX */
        pins = "GPIO_44", "GPIO_45";
        function = "fc2_b";
    };
};

&amp;flx2 {
    atmel,flexcom-mode = &lt;ATMEL_FLEXCOM_MODE_TWI&gt;;
    status = "okay";

    i2c0: i2c@600 {

    pinctrl-0 = &lt;&amp;fc0_b_pins&gt;;
        pinctrl-names = "default";
        atmel,fifo-size = &lt;32&gt;;
        i2c-analog-filter;
        i2c-digital-filter;
        i2c-digital-filter-width-ns = &lt;35&gt;;
        status = "okay";

        eeprom: eeprom@50 {
                compatible = "atmel,24c512";
                reg = &lt;0x50&gt;;
                pagesize = &lt;128&gt;;
                status = "okay";
        };
    };
};</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_userspace"><a class="anchor" href="#_userspace"></a>UserSpace</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_confirm_instances_are_created"><a class="anchor" href="#_confirm_instances_are_created"></a>Confirm instances are created</h3>
<div class="paragraph">
<p>To confirm if i2c flash is created:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Check if flash device is created in <code>/sys/bus/i2c/devices/</code> directory.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_example_on_how_to_use"><a class="anchor" href="#_example_on_how_to_use"></a>Example on how to use</h3>
<div class="paragraph">
<p>Following example shows how to read/write to I2C eeprom device:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># dmesg | grep i2c
[    5.749296] at91_i2c e0060600.i2c: can't get DMA channel, continue without DMA support
[    5.757431] at91_i2c e0060600.i2c: Using FIFO (32 data)
[    5.763341] at91_i2c e0060600.i2c: recovery information incomplete
[    5.782333] at91_i2c e0060600.i2c: AT91 i2c bus driver (hw version: 0x820).
#
# dmesg | grep EEPROM
[    5.774793] at24 0-0050: 65536 byte 24c512 EEPROM, writable, 128 bytes/write
#
# cat /proc/interrupts | grep i2c
 32:      65538     GIC-0  82 Level     e0060600.i2c
#
# echo "02_09: Sunrise: Testing TWI on Drop_7C. I2C EEPROM is detected and able
to read it" &gt; /sys/bus/i2c/devices/0-0050/eeprom
#
#
# more /sys/bus/i2c/devices/0-0050/eeprom | od -c
0000000   0   2   _   0   9   :       S   u   n   r   i   s   e   :
0000020   T   e   s   t   i   n   g       T   W   I       o   n       D
0000040   r   o   p   _   7   C   .       I   2   C       E   E   P   R
0000060   O   M       i   s       d   e   t   e   c   t   e   d       a
0000100   n   d       a   b   l   e       t   o       r   e   a   d
0000120   i   t  \n   K   b   i   t   )       S   e   r   i   a   l
0000140   E   l   e   c   t   r   i   c   a   l   l   y       E   r   a
0000160   s   a   b   l   e       P   R   O   M  \n 377 377 377 377 377
0000200 377 377 377 377 377 377 377 377 377 377 377 377 377 377 377 377
*
0010400 377 377 377 377 377   V 377 377 377 377 377 377 377 377 377 377
0010420 377 377 377 377 377 377 377 377 377 377 377 377 377 377 377 377
*
0011000 377   T   h   i   s       i   s       C   P   U       T   W   I
0011020       M   a   s   t   e   r       m   o   d   e       t   e   s
0011040   t  \0 377 377 377 377 377 377 377 377 377 377 377 377 377 377
0011060 377 377 377 377 377 377 377 377 377 377 377 377 377 377 377 377
*
0011400  \0 021   "   3   D   U   f   w 210 231 252 273 314 335 356 377
0011420 377 377 377 377 377 377 377 377 377 377 377 377 377 377 377 377
*
0200000
#</pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  This page was built using <a href="https://antora.org">Antora</a>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
