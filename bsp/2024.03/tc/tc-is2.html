<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ACL (IS2) :: Microchip UNG BSP Documentation</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">Microchip UNG BSP Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="bsp" data-version="2024.03">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">BSP Releases</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">ReadMe</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../release-notes/nav.html">Release Notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../getting-started.html">Getting started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../bootloader.html">Bootloader</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Supported HW</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../supported-hw/lan966x.html">LAN966x</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-boot.html">Booting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-restore-secureboot.html">Restoring SecureBoot Images</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-tfa.html">SecureBoot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-tfa_ctl.html">TFA_CTL</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-overlays.html">Overlays</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-flexcom.html">FLEXCOM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-usart.html">USART</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-spi.html">SPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-i2c.html">I2C</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-qspi.html">QSPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-mmc.html">MMC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-pinctrl.html">GPIO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-mcan.html">MCAN</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-wdt.html">Watchdog Timer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-aes-sha.html">Crypto HW Accelerators</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-otp.html">OTP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-udphs.html">UDPHS - USB Device</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan966x-pcie-rpi4cm.html">PCIe NIC with RPI CM4</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../supported-hw/sparx5.html">Sparx5</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../supported-hw/lan969x.html">LAN969x</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-boot.html">Booting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/restore-secureboot.html">Restoring SecureBoot Images</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-tfa.html">SecureBoot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-verified-boot.html">Verified Boot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-flexcom.html">FLEXCOM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-usart.html">USART</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-spi.html">SPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-i2c.html">I2C</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-qspi.html">QSPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-mmc.html">MMC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-pinctrl.html">GPIO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-sgpio.html">SGPIO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-mcan.html">MCAN</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-wdt.html">Watchdog Timer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../supported-hw/lan969x-usb.html">USB Host Device</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Network</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../network_overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tools_overview.html">Tools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../front_ports.html">Front Ports</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">L2 Bridge</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../bridge_configuration.html">Bridge Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Frame Forwarding</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../forwarding_overview.html">Forwarding Overview</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../frame_meta_data.html">Frame Metadata</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="tc-intro.html">TC Introduction</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="tc-flower-vcap.html">TC and VCAP</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../vcap_tool.html">VCAP tool</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ingress</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../basic_qos.html">Basic QoS</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="tc-is1.html">Classification (IS0/IS1)</a>
  </li>
  <li class="nav-item is-current-page" data-depth="5">
    <a class="nav-link" href="tc-is2.html">ACL (IS2)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../policing.html">Policing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Egress</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../scheduling.html">Scheduling</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../frame_preemption.html">Frame Preemption</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../shaping.html">Shaping</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="tc-es2.html">Egress ACL (ES2)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="tc-etag.html">Basic VLAN tagging</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="tc-es0.html">Rewriter VLAN tagging (ES0)</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../psfp.html">PSFP</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../frer.html">FRER</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Protection switching</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../mrp.html">MRP</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cfm.html">CFM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ptp.html">PTP</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">BSP Releases</span>
    <span class="version">2024.03</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">BSP Releases</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2024.03</a>
        </li>
        <li class="version">
          <a href="../../2024.03-1/index.html">2024.03-1</a>
        </li>
        <li class="version">
          <a href="../../2023.12/index.html">2023.12</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="#">Older (on AWS)</a>
      <ul class="versions">
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.09-1.html">2023.09-1</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.09.html">2023.09</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.06.html">2023.06</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2023.03.html">2023.03</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.12.html">2022.12</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.09.html">2022.09</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.06.html">2022.06</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2022.03.html">2022.03</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2021.12.html">2021.12</a>
        </li>
        <li class="version">
          <a href="http://mscc-ent-open-source.s3-eu-west-1.amazonaws.com/public_root/bsp/mscc-brsdk-doc-2021.09.html">2021.09</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">BSP Releases</a></li>
    <li>Network</li>
    <li>L2 Bridge</li>
    <li>Frame Forwarding</li>
    <li>Ingress</li>
    <li><a href="tc-is2.html">ACL (IS2)</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">2024.03</button>
  <div class="version-menu">
    <a class="version is-current" href="tc-is2.html">2024.03</a>
    <a class="version" href="../../2024.03-1/tc/tc-is2.html">2024.03-1</a>
    <a class="version" href="../../2023.12/tc/tc-is2.html">2023.12</a>
  </div>
</div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">ACL (IS2)</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>ACL (access-control list) in Microchip switch products is based on VCAP IS2 lookups and can be used for the following
purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Permit frame</p>
</li>
<li>
<p>Drop frame</p>
</li>
<li>
<p>Police frame</p>
</li>
<li>
<p>Mirror frame</p>
</li>
<li>
<p>Extract frame to CPU</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a frame is received on a port it is classified into one of the following traffic types by the IS2 VCAP:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Traffic Type</th>
<th class="tableblock halign-center valign-top">Sparx5</th>
<th class="tableblock halign-center valign-top">LAN966x</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IPv4 MC</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IPv4 UC</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IPv6 MC</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IPv6 UC</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IPv4 TCP/UDP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IPv4 Other</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IPv6 TCP/UDP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IPv6 Other</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OAM</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SNAP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LLC</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARP/RARP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Other frames</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All frame types are subject to the appropriate lookups according to the VCAP.  See
<a href="tc-flower-vcap.html#vcap_info" class="xref page">VCAP Information</a>.</p>
</div>
<div class="paragraph">
<p>Each port is configured to generate a specific keyset (a set of key values extracted from a frame) for each combination
of Traffic Type and lookup.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A keyset is an internal value used by the hardware. A flower key is what the user specifies in the tc flower
filter command.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sparx5_is2_acl_frame_classification"><a class="anchor" href="#_sparx5_is2_acl_frame_classification"></a>1. Sparx5 IS2 ACL frame classification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The valid combinations of Sparx5 IS2 lookup keyset versus Traffic Type are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 37.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Sparx5 IS2 keyset - Traffic Type</th>
<th class="tableblock halign-center valign-top">Size</th>
<th class="tableblock halign-center valign-top">IPv4 UC/MC</th>
<th class="tableblock halign-center valign-top">IPv6 UC/MC</th>
<th class="tableblock halign-center valign-top">ARP/RARP</th>
<th class="tableblock halign-center valign-top">Other</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_arp">ARP</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_ip4_other">IP4_OTHER</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_ip4_tcp_udp">IP4_TCP_UDP</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_ip_7tuple">IP_7TUPLE</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_mac_etype">MAC_ETYPE</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The unicast and multicast configurations are set to the same value.</p>
</div>
<div class="paragraph">
<p>The IPv4 configuration can be setup to generate IP4_TCP_UDP for IPv4 TCP/UDP traffic and IP4_OTHER for non-TCP/UDP IPv4
traffic.</p>
</div>
<div class="paragraph">
<p>Similarly the IPv6 configuration can be setup to generate IP4_TCP_UDP for IPv6 TCP/UDP traffic and IP4_OTHER for
non-TCP/UDP IPv6 traffic.</p>
</div>
<div class="paragraph">
<p>In this release the Sparx5s port keyset configuration varies for the 4 IS2 lookups:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6669%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Sparx5 IS2 Lookup - Traffic Type</th>
<th class="tableblock halign-center valign-top">IPv4 UC/MC</th>
<th class="tableblock halign-center valign-top">IPv6 UC/MC</th>
<th class="tableblock halign-center valign-top">ARP/RARP</th>
<th class="tableblock halign-center valign-top">Other</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Lookup 0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">MAC_ETYPE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">MAC_ETYPE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">MAC_ETYPE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">MAC_ETYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Lookup 1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">IP4_TCP_UDP IP4_OTHER</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">IP_7TUPLE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">ARP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">MAC_ETYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Lookup 2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">IP_7TUPLE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">IP_7TUPLE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">ARP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">MAC_ETYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Lookup 3</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">IP_7TUPLE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">IP_7TUPLE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">MAC_ETYPE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">MAC_ETYPE</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This will most likely be changed so that all lookups use the same configuration in a future release, as it is possible
to change the configuration by using a template, and LAN966x uses the same configuration for all lookups.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lan966x_is2_acl_frame_classification"><a class="anchor" href="#_lan966x_is2_acl_frame_classification"></a>2. LAN966x IS2 ACL frame classification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The valid combinations of Sparx5 IS2 lookup keyset versus Traffic Type are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3336%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">LAN966x IS2 keyset - Traffic Type</th>
<th class="tableblock halign-center valign-top">Size</th>
<th class="tableblock halign-center valign-top">IPv4 TCP/UDP</th>
<th class="tableblock halign-center valign-top">IPv4 Other</th>
<th class="tableblock halign-center valign-top">IPv6 TCP/UDP</th>
<th class="tableblock halign-center valign-top">IP6 Other</th>
<th class="tableblock halign-center valign-top">OAM</th>
<th class="tableblock halign-center valign-top">SNAP</th>
<th class="tableblock halign-center valign-top">ARP/RARP</th>
<th class="tableblock halign-center valign-top">Other</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_arp">ARP</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_ip4_other">IP4_OTHER</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_ip4_tcp_udp">IP4_TCP_UDP</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_ip6_other">IP6_OTHER</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_ip6_tcp_udp">IP6_TCP_UDP</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_mac_etype">MAC_ETYPE</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_mac_llc">MAC_LLC</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_mac_snap">MAC_SNAP</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_oam">OAM</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The IS2 VCAP has two additional lookup keys, IP6_STD and CUSTOM, which are currently not used.</p>
</div>
<div class="paragraph">
<p>The IP6 keys are twice as large as the other keys which means that they occupy twice as much space in the VCAP when used.</p>
</div>
<div class="paragraph">
<p>The supported flower keys for each IS2 lookup keyset are described next and here is also shown examples on how to use the actions.</p>
</div>
<div class="paragraph">
<p>A more thorough description of the actions is found in the section <a href="#is2-actions">IS2 Actions</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_is2_keysets"><a class="anchor" href="#_is2_keysets"></a>3. IS2 keysets</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_ip_7tuple"><a class="anchor" href="#_ip_7tuple"></a>3.1. IP_7TUPLE</h3>
<div class="paragraph">
<p>This keyset is used for both IPv4 and IPv6 traffic.  It does not have IPv4 source and destination addresses though.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flower key</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_mac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;MAC_ADDR&gt; or &lt;MAC_ADDR&gt;/&lt;MAC_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_mac 00:33:33:33:33:33 or src_mac&#160;00:33:33:00:00:00/ff:ff:ff:00:00:00</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_mac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;MAC_ADDR&gt; or &lt;MAC_ADDR&gt;/&lt;MAC_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_mac&#160;00:44:44:44:44:44 or dst_mac&#160;00:44:44:00:00:00/ff:ff:ff:00:00:00</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;VID&gt; or &lt;VID&gt;/&lt;VID_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id&#160;1234 or vlan_id&#160;0x100/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PCP&gt; or &lt;PCP&gt;/&lt;PCP_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio&#160;3 or vlan_id&#160;0x0/0x1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype&#160;802.1q or vlan_ethtype&#160;ip</p>
<p class="tableblock"><strong>Note: Supports the same values as in <code>tc filter</code> protocol field.</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_flags</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IP_FLAG&gt;[/&lt;IP_FLAG&gt;]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_flags { [no]frag | [no]firstfrag }</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_tos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;TOS&gt; or &lt;TOS&gt;/&lt;TOS_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_tos&#160;0x12 or ip_tos&#160;0x4/0x3f.</p>
<p class="tableblock"><strong>Note: Only the 6 LSBs can be matched in IS1 (The DSCP part).</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_ip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IPv6 ADDR&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_ip&#160;2001:0:0:0:e1de:2244:0ff8:0123</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_ip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IPv6 ADDR&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_ip&#160;2001:0:0:0:e1de:2244:0ff8:4567</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_proto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IP_PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_proto&#160;6, ip_proto&#160;tcp, ip_proto&#160;17 or ip_proto&#160;udp.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PORT&gt; or &lt;PORT&gt;/&lt;PORT_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_port 1000 or src_port&#160;0x200/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PORT&gt; or &lt;PORT&gt;/&lt;PORT_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_port 2000 or dst_port&#160;0x100/0xff0</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This filter matches on classified VLAN tag, and all supported IPv6/TCP fields.</p>
</div>
<div class="paragraph">
<p>The filter in inserted into chain 8200000 (lookup 2), traps all matching packets and goes to lookup 3 in IS2 (chain
8300000).</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8200000 prio 10 handle 42 protocol 802.1q flower skip_sw \
  vlan_id 100 \
  vlan_prio 1 \
  vlan_ethtype ipv6 \
  ip_ttl 1 \
  ip_tos 0xf/0x3f \
  src_ip 2001:0db8:3c4d:0015:e1de:2244:0ff8:0123 \
  dst_ip 2001:0db8:3c4d:0015:e1de:2244:0ff8:4567/64 \
  ip_proto tcp \
  tcp_flags 0x10/0x3f \
  src_port 1000 \
  dst_port 2000 \
  action trap \
  action goto chain 8300000</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ip6_tcp_udp"><a class="anchor" href="#_ip6_tcp_udp"></a>3.2. IP6_TCP_UDP</h3>
<div class="paragraph">
<p>This keyset is generated when Ethertype is 0x86dd and Next header is either TCP (6) or UDP (17).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flower key</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;VID&gt; or &lt;VID&gt;/&lt;VID_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id&#160;1234 or vlan_id&#160;0x100/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PCP&gt; or &lt;PCP&gt;/&lt;PCP_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio&#160;3 or vlan_id&#160;0x0/0x1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype&#160;ipv6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_ttl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;TTL&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_ttl 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_tos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;TOS&gt; or &lt;TOS&gt;/&lt;TOS_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_tos&#160;0x12 or ip_tos&#160;0x4/0x3f</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_ip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IPv6_ADDR&gt; or &lt;IPv6_ADDR&gt;/&lt;PREFIX&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_ip&#160;2001:0db8:3c4d:0015:e1de:2244:0ff8:0123 or src_ip&#160;2001:0db8:3c4d:0015:e1de:2244:0ff8:0123/32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_ip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IPv6_ADDR&gt; or &lt;IPv6_ADDR&gt;/&lt;PREFIX&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_ip&#160;2001:0db8:3c4d:0015:e1de:2244:0ff8:4567 or dst_ip&#160;2001:0db8:3c4d:0015:e1de:2244:0ff8:4567/64</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_proto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IP_PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_proto&#160;6, ip_proto&#160;tcp, ip_proto&#160;17 or ip_proto&#160;udp.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tcp_flags</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;FLAGS&gt; or &lt;FLAGS&gt;/&lt;FLAGS_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tcp_flags&#160;0x1a or tcp_flags&#160;0x10/0x3f</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PORT&gt; or &lt;PORT&gt;/&lt;PORT_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_port 1000 or src_port&#160;0x200/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PORT&gt; or &lt;PORT&gt;/&lt;PORT_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_port 2000 or dst_port&#160;0x100/0xff0</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This filter matches on classified VLAN tag, and all supported IPv6/TCP fields.</p>
</div>
<div class="paragraph">
<p>The filter in inserted into chain 8000000 (first lookup), drops all matching packets and goes to second lookup in IS2 (chain 8100000).</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol 802.1q flower skip_sw \
  vlan_id 100 \
  vlan_prio 1 \
  vlan_ethtype ipv6 \
  ip_ttl 1 \
  ip_tos 0xf/0x3f \
  src_ip 2001:0db8:3c4d:0015:e1de:2244:0ff8:0123 \
  dst_ip 2001:0db8:3c4d:0015:e1de:2244:0ff8:4567/64 \
  ip_proto tcp \
  tcp_flags 0x10/0x3f \
  src_port 1000 \
  dst_port 2000 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
<div class="paragraph">
<p>This filter is the same as above but without VLAN matching.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol ipv6 flower skip_sw \
  ip_ttl 1 \
  ip_tos 0xf/0x3f \
  src_ip 2001:0db8:3c4d:0015:e1de:2244:0ff8:0123 \
  dst_ip 2001:0db8:3c4d:0015:e1de:2244:0ff8:4567/64 \
  ip_proto tcp \
  tcp_flags 0x10/0x3f \
  src_port 1000 \
  dst_port 2000 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ip6_other"><a class="anchor" href="#_ip6_other"></a>3.3. IP6_OTHER</h3>
<div class="paragraph">
<p>This keyset is generated when Ethertype is 0x86dd and Next header is neither TCP (6) nor UDP (17).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flower key</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;VID&gt; or &lt;VID&gt;/&lt;VID_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id&#160;1234 or vlan_id&#160;0x100/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PCP&gt; or &lt;PCP&gt;/&lt;PCP_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio&#160;3 or vlan_id&#160;0x0/0x1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype&#160;ipv6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_ttl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;TTL&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_ttl 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_tos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;TOS&gt; or &lt;TOS&gt;/&lt;TOS_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_tos&#160;0x12 or ip_tos&#160;0x4/0x3f</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_ip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IPv6_ADDR&gt; or &lt;IPv6_ADDR&gt;/&lt;PREFIX&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_ip&#160;2001:0db8:3c4d:0015:e1de:2244:0ff8:0123 or src_ip&#160;2001:0db8:3c4d:0015:e1de:2244:0ff8:0123/32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_ip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IPv6_ADDR&gt; or &lt;IPv6_ADDR&gt;/&lt;PREFIX&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_ip&#160;2001:0db8:3c4d:0015:e1de:2244:0ff8:4567 or dst_ip&#160;2001:0db8:3c4d:0015:e1de:2244:0ff8:4567/64</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_proto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IP_PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_proto&#160;58 or ip_proto&#160;icmpv6.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This filter matches on classified VLAN tag, and all supported IPv6 fields.</p>
</div>
<div class="paragraph">
<p>The filter in inserted into chain 8000000 (first lookup), drops all matching packets and goes to second lookup in IS2 (chain 8100000).</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol 802.1q flower skip_sw \
  vlan_id 100 \
  vlan_prio 1 \
  vlan_ethtype ipv6 \
  ip_ttl 1 \
  ip_tos 0xf/0x3f \
  src_ip 2001:0db8:3c4d:0015:e1de:2244:0ff8:0123 \
  dst_ip 2001:0db8:3c4d:0015:e1de:2244:0ff8:4567/64 \
  ip_proto icmpv6 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
<div class="paragraph">
<p>This filter is the same as above but without VLAN matching.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol ipv6 flower skip_sw \
  ip_ttl 1 \
  ip_tos 0xf/0x3f \
  src_ip 2001:0db8:3c4d:0015:e1de:2244:0ff8:0123 \
  dst_ip 2001:0db8:3c4d:0015:e1de:2244:0ff8:4567/64 \
  ip_proto icmpv6 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ip4_tcp_udp"><a class="anchor" href="#_ip4_tcp_udp"></a>3.4. IP4_TCP_UDP</h3>
<div class="paragraph">
<p>This keyset is generated when Ethertype is 0x0800 and IP protocol is either TCP (6) or UDP (17).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flower key</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;VID&gt; or &lt;VID&gt;/&lt;VID_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id&#160;1234 or vlan_id&#160;0x100/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PCP&gt; or &lt;PCP&gt;/&lt;PCP_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio&#160;3 or vlan_id&#160;0x0/0x1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype&#160;ipv4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_ttl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;TTL&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_ttl 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_tos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;TOS&gt; or &lt;TOS&gt;/&lt;TOS_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_tos&#160;0x12 or ip_tos&#160;0x4/0x3f</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_flags</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IP_FLAG&gt;[/&lt;IP_FLAG&gt;]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_flags { [no]frag | [no]firstfrag }</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_ip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IPv4_ADDR&gt; or &lt;IPv4_ADDR&gt;/&lt;IPv4_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_ip 10.10.10.10 or src_ip&#160;10.10.0.0/255.255.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_ip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IPv4_ADDR&gt; or &lt;IPv4_ADDR&gt;/&lt;IPv4_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_ip 20.20.20.20, dst_ip&#160;20.20.0.0/255.255.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_proto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IP_PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_proto&#160;6, ip_proto&#160;tcp, ip_proto&#160;17 or ip_proto&#160;udp.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tcp_flags</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;FLAGS&gt; or &lt;FLAGS&gt;/&lt;FLAGS_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tcp_flags&#160;0x1a or tcp_flags&#160;0x10/0x3f</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PORT&gt; or &lt;PORT&gt;/&lt;PORT_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_port 1000 or src_port&#160;0x200/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PORT&gt; or &lt;PORT&gt;/&lt;PORT_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_port 2000 or dst_port&#160;0x100/0xff0</p>
<p class="tableblock">NOTE: Sparx5: Use Lookup 1 as this is configured with the IP4_OTHER keyset.  The drop action is not available for IS2.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This filter matches on classified VLAN tag, and all supported IPv4/TCP fields.</p>
</div>
<div class="paragraph">
<p>The filter in inserted into chain 8000000 (first lookup), drops all matching packets and goes to second lookup in IS2 (chain 8100000).</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol 802.1q flower skip_sw \
  vlan_id 100 \
  vlan_prio 1 \
  vlan_ethtype ipv4 \
  ip_ttl 1 \
  ip_tos 0xf/0x3f \
  ip_flags frag/nofirstfrag \
  src_ip 10.10.10.10  \
  dst_ip 20.20.20.20/255.255.0.0 \
  ip_proto tcp \
  tcp_flags 0x10/0x3f \
  src_port 1000 \
  dst_port 2000 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
<div class="paragraph">
<p>This filter is the same as above but without VLAN matching.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol ipv4 flower skip_sw \
  ip_ttl 1 \
  ip_tos 0xf/0x3f \
  ip_flags frag/nofirstfrag \
  src_ip 10.10.10.10  \
  dst_ip 20.20.20.20/255.255.0.0 \
  ip_proto tcp \
  tcp_flags 0x10/0x3f \
  src_port 1000 \
  dst_port 2000 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ip4_other"><a class="anchor" href="#_ip4_other"></a>3.5. IP4_OTHER</h3>
<div class="paragraph">
<p>This keyset is generated when Ethertype is 0x0800 and IP protocol is neither TCP (6) nor UDP (17).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flower key</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;VID&gt; or &lt;VID&gt;/&lt;VID_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id&#160;1234 or vlan_id&#160;0x100/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PCP&gt; or &lt;PCP&gt;/&lt;PCP_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio&#160;3 or vlan_id&#160;0x0/0x1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype&#160;ipv4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_ttl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;TTL&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_ttl 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_tos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;TOS&gt; or &lt;TOS&gt;/&lt;TOS_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_tos&#160;0x12 or ip_tos&#160;0x4/0x3f</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_flags</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IP_FLAG&gt;[/&lt;IP_FLAG&gt;]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_flags { [no]frag | [no]firstfrag }</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_ip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IPv4_ADDR&gt; or &lt;IPv4_ADDR&gt;/&lt;IPv4_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_ip 10.10.10.10 or src_ip&#160;10.10.0.0/255.255.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_ip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IPv4_ADDR&gt; or &lt;IPv4_ADDR&gt;/&lt;IPv4_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_ip 20.20.20.20, dst_ip&#160;20.20.0.0/255.255.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_proto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IP_PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_proto&#160;1 or ip_proto&#160;icmp.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This filter matches on classified VLAN tag, and all supported IPv4 fields.</p>
</div>
<div class="paragraph">
<p>The filter in inserted into chain 8000000 (first lookup), drops all matching packets and goes to second lookup in IS2 (chain 8100000).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Sparx5: Use Lookup 1 as this is configured with the IP4_OTHER keyset.  The drop action is not available for IS2.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol 802.1q flower skip_sw \
  vlan_id 100 \
  vlan_prio 1 \
  vlan_ethtype ipv4 \
  ip_ttl 1 \
  ip_tos 0xf/0x3f \
  ip_flags frag/nofirstfrag \
  src_ip 10.10.10.10  \
  dst_ip 20.20.20.20/255.255.0.0 \
  ip_proto icmp \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
<div class="paragraph">
<p>This filter is the same as above but without VLAN matching.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol ipv4 flower skip_sw \
  ip_ttl 1 \
  ip_tos 0xf/0x3f \
  ip_flags frag/nofirstfrag \
  src_ip 10.10.10.10  \
  dst_ip 20.20.20.20/255.255.0.0 \
  ip_proto icmp \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_arp"><a class="anchor" href="#_arp"></a>3.6. ARP</h3>
<div class="paragraph">
<p>This keyset is generated when Ethertype is 0x0806 (ARP) or 0x8035 (RARP).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flower key</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;VID&gt; or &lt;VID&gt;/&lt;VID_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id&#160;1234 or vlan_id&#160;0x100/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PCP&gt; or &lt;PCP&gt;/&lt;PCP_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio&#160;3 or vlan_id&#160;0x0/0x1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype&#160;arp or vlan_ethtype&#160;rarp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_mac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;MAC_ADDR&gt; or &lt;MAC_ADDR&gt;/&lt;MAC_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_mac 00:33:33:33:33:33 or src_mac&#160;00:33:33:00:00:00/ff:ff:ff:00:00:00</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arp_tip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IPv4_ADDR&gt; or &lt;IPv4_ADDR&gt;/&lt;IPv4_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">arp_tip 10.10.10.10 or arp_tip&#160;10.10.0.0/255.255.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arp_sip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;IPv4_ADDR&gt; or &lt;IPv4_ADDR&gt;/&lt;IPv4_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">arp_sip 10.10.10.10 or arp_sip&#160;10.10.0.0/255.255.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arp_op</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">request or reply</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">arp_op&#160;request or arp_op&#160;reply</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This filter matches on classified VLAN tag, and all supported IPv4 fields.</p>
</div>
<div class="paragraph">
<p>The filter in inserted into chain 8000000 (first lookup), drops all matching packets and goes to second lookup in IS2 (chain 8100000).</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol 802.1q flower skip_sw \
  vlan_id 100 \
  vlan_prio 1 \
  vlan_ethtype arp \
  src_mac 00:33:33:33:33:33 \
  arp_tip 10.10.10.10  \
  arp_sip 20.20.20.20/255.255.0.0 \
  arp_op reply \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
<div class="paragraph">
<p>This filter is the same as above but without VLAN matching.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol arp flower skip_sw \
  src_mac 00:33:33:33:33:33 \
  arp_tip 10.10.10.10  \
  arp_sip 20.20.20.20/255.255.0.0 \
  arp_op reply \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Sparx5: Use Lookup 1 or 2 as this is configured with the ARP keyset.  The drop action is not available for IS2.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_oam"><a class="anchor" href="#_oam"></a>3.7. OAM</h3>
<div class="paragraph">
<p>This keyset is generated when Ethertype is 0x8809 (Ethernet slow protocols), 0x88ee (MEF 16 E-LMI) or  0x8902 (IEEE 802.1ag Connectivity Fault Management).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flower key</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;VID&gt; or &lt;VID&gt;/&lt;VID_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id&#160;1234 or vlan_id&#160;0x100/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PCP&gt; or &lt;PCP&gt;/&lt;PCP_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio&#160;3 or vlan_id&#160;0x0/0x1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype&#160;0x8809, vlan_ethtype&#160;0x88ee or vlan_ethtype&#160;0x8902</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_mac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;MAC_ADDR&gt; or &lt;MAC_ADDR&gt;/&lt;MAC_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_mac 00:33:33:33:33:33 or src_mac&#160;00:33:33:00:00:00/ff:ff:ff:00:00:00</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_mac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;MAC_ADDR&gt; or &lt;MAC_ADDR&gt;/&lt;MAC_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_mac&#160;00:44:44:44:44:44 or dst_mac&#160;00:44:44:00:00:00/ff:ff:ff:00:00:00</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This filter matches on classified VLAN tag, and all supported OAM fields.</p>
</div>
<div class="paragraph">
<p>The filter in inserted into chain 8000000 (first lookup), drops all matching packets and goes to second lookup in IS2 (chain 8100000).</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol 802.1q flower skip_sw \
  vlan_id 100 \
  vlan_prio 1 \
  vlan_ethtype 0x8809 \
  src_mac 00:33:33:33:33:33 \
  dst_mac 00:44:44:44:00:00/ff:ff:ff:ff:00:00 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
<div class="paragraph">
<p>This filter is the same as above but without VLAN matching.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol 0x8809 flower skip_sw \
  src_mac 00:33:33:33:33:33 \
  dst_mac 00:44:44:44:00:00/ff:ff:ff:ff:00:00 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mac_snap"><a class="anchor" href="#_mac_snap"></a>3.8. MAC_SNAP</h3>
<div class="paragraph">
<p>This keyset is generated when Ethertype is less than 0x600 and LLC header is a SNAP header (0xaaaa03).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flower key</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;VID&gt; or &lt;VID&gt;/&lt;VID_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id&#160;1234 or vlan_id&#160;0x100/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PCP&gt; or &lt;PCP&gt;/&lt;PCP_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio&#160;3 or vlan_id&#160;0x0/0x1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype&#160;snap</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_mac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;MAC_ADDR&gt; or &lt;MAC_ADDR&gt;/&lt;MAC_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_mac 00:33:33:33:33:33 or src_mac&#160;00:33:33:00:00:00/ff:ff:ff:00:00:00</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_mac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;MAC_ADDR&gt; or &lt;MAC_ADDR&gt;/&lt;MAC_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_mac&#160;00:44:44:44:44:44 or dst_mac&#160;00:44:44:00:00:00/ff:ff:ff:00:00:00</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This filter matches on classified VLAN tag, and all supported SNAP fields.</p>
</div>
<div class="paragraph">
<p>The filter in inserted into chain 8000000 (first lookup), drops all matching packets and goes to second lookup in IS2 (chain 8100000).</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol 802.1q flower skip_sw \
  vlan_id 100 \
  vlan_prio 1 \
  vlan_ethtype snap \
  src_mac 00:33:33:33:33:33 \
  dst_mac 00:44:44:44:00:00/ff:ff:ff:ff:00:00 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
<div class="paragraph">
<p>This filter is the same as above but without VLAN matching.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol snap flower skip_sw \
  src_mac 00:33:33:33:33:33 \
  dst_mac 00:44:44:44:00:00/ff:ff:ff:ff:00:00 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mac_llc"><a class="anchor" href="#_mac_llc"></a>3.9. MAC_LLC</h3>
<div class="paragraph">
<p>This keyset is generated when Ethertype is less than 0x600 and LLC header is not a SNAP header.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flower key</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;VID&gt; or &lt;VID&gt;/&lt;VID_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id&#160;1234 or vlan_id&#160;0x100/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PCP&gt; or &lt;PCP&gt;/&lt;PCP_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio&#160;3 or vlan_id&#160;0x0/0x1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype&#160;802_2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_mac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;MAC_ADDR&gt; or &lt;MAC_ADDR&gt;/&lt;MAC_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_mac 00:33:33:33:33:33 or src_mac&#160;00:33:33:00:00:00/ff:ff:ff:00:00:00</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_mac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;MAC_ADDR&gt; or &lt;MAC_ADDR&gt;/&lt;MAC_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_mac&#160;00:44:44:44:44:44 or dst_mac&#160;00:44:44:00:00:00/ff:ff:ff:00:00:00</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This filter matches on classified VLAN tag, and all supported LLC fields.</p>
</div>
<div class="paragraph">
<p>The filter in inserted into chain 8000000 (first lookup), drops all matching packets and goes to second lookup in IS2 (chain 8100000).</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol 802.1q flower skip_sw \
  vlan_id 100 \
  vlan_prio 1 \
  vlan_ethtype 802_2 \
  src_mac 00:33:33:33:33:33 \
  dst_mac 00:44:44:44:00:00/ff:ff:ff:ff:00:00 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
<div class="paragraph">
<p>This filter is the same as above but without VLAN matching.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol 802_2 flower skip_sw \
  src_mac 00:33:33:33:33:33 \
  dst_mac 00:44:44:44:00:00/ff:ff:ff:ff:00:00 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mac_etype"><a class="anchor" href="#_mac_etype"></a>3.10. MAC_ETYPE</h3>
<div class="paragraph">
<p>This keyset is generated when frame is not classified to one of the above keys.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flower key</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;VID&gt; or &lt;VID&gt;/&lt;VID_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_id&#160;1234 or vlan_id&#160;0x100/0xff0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PCP&gt; or &lt;PCP&gt;/&lt;PCP_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_prio&#160;3 or vlan_id&#160;0x0/0x1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;PROTO&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlan_ethtype&#160;0x892f or vlan_ethtype&#160;hsr</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_mac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;MAC_ADDR&gt; or &lt;MAC_ADDR&gt;/&lt;MAC_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src_mac 00:33:33:33:33:33 or src_mac&#160;00:33:33:00:00:00/ff:ff:ff:00:00:00</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_mac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;MAC_ADDR&gt; or &lt;MAC_ADDR&gt;/&lt;MAC_ADDR_MASK&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dst_mac&#160;00:44:44:44:44:44 or dst_mac&#160;00:44:44:00:00:00/ff:ff:ff:00:00:00</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This filter matches on classified VLAN tag, and all supported ETYPE fields.</p>
</div>
<div class="paragraph">
<p>The filter in inserted into chain 8000000 (first lookup), drops all matching packets and goes to second lookup in IS2 (chain 8100000).</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol 802.1q flower skip_sw \
  vlan_id 100 \
  vlan_prio 1 \
  vlan_ethtype hsr \
  src_mac 00:33:33:33:33:33 \
  dst_mac 00:44:44:44:00:00/ff:ff:ff:ff:00:00 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Sparx5: The HSR ethtype is not supported.  The drop action is not available for IS2.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This filter is the same as above but without VLAN matching.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc qdisc add dev eth0 clsact

# tc filter add dev eth0 ingress chain 8000000 prio 10 handle 42 protocol hsr flower skip_sw \
  src_mac 00:33:33:33:33:33 \
  dst_mac 00:44:44:44:00:00/ff:ff:ff:ff:00:00 \
  action drop \
  action goto chain 8100000</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="is2-actions"><a class="anchor" href="#is2-actions"></a>3.11. IS2 Actions</h3>
<div class="paragraph">
<p>The IS2 lookups supports the actions shown in this table.
Some actions are only supported on one switch and some action are not available in all lookups.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 31.25%;">
<col style="width: 31.25%;">
<col style="width: 31.25%;">
<col style="width: 3.125%;">
<col style="width: 3.125%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flower action</th>
<th class="tableblock halign-left valign-top">Example</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-center valign-top">Sparx5</th>
<th class="tableblock halign-center valign-top">LAN966x</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pass</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action pass</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is a no-op action.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">trap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action trap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Drop the frame and send a copy to the CPU.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">drop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action drop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Drop the frame.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">police rate &lt;RATE&gt; burst &lt;BURST&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action police rate 100kbit burst 16000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Police the frames to a specific bit rate.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">Only Lookup 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mirror to dev &lt;DEV&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action mirred egress mirror dev eth3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mirror the frame on monitor port eth3.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">redirect to dev &lt;DEV&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action mirred egress redirect dev eth3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redirect the frame to port eth3.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="red">&#x00b7;</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">goto chain &lt;CHAIN&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action goto chain 8100000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Which chain to go to after this match. A no-op action in second lookup. In first lookup the chain number is used to match the PAG value that was assigned in the third lookup in the IS1 VCAP.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong class="green">&#x2714;</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_is2_status"><a class="anchor" href="#_is2_status"></a>3.12. IS2 Status</h3>
<div class="paragraph">
<p>Use the <code>tc filter show</code> command to see the filter configuration for a specific port.</p>
</div>
<div class="paragraph">
<p>Add <code>-s</code> to also see the statistics:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tc -s filter show dev eth2 ingress
  filter protocol all pref 65535 flower chain 1200000
  filter protocol all pref 65535 flower chain 1200000 handle 0x2a
  dst_mac 00:44:44:44:44:44/24
  src_mac 00:33:33:33:33:33/24
  skip_sw
  in_hw in_hw_count 1
  action order 1: gact action goto chain 8000002
  random type none pass val 0
  index 1 ref 1 bind 1 installed 11 sec used 11 sec
  Action statistics:
  Sent 0 bytes 10014 pkt (dropped 0, overlimits 0 requeues 0)
  Sent software 0 bytes 0 pkt
  Sent hardware 0 bytes 10014 pkt
  backlog 0b 0p requeues 0
  used_hw_stats immediate

  filter protocol all pref 100 flower chain 8000002
  filter protocol all pref 100 flower chain 8000002 handle 0xc8
  skip_sw
  in_hw in_hw_count 1
  action order 1:  police 0xa rate 100Mbit burst 16000b mtu 2Kb action reclassify overhead 0b
  ref 2 bind 1  installed 6 sec used 6 sec
  Action statistics:
  Sent 0 bytes 10000 pkt (dropped 0, overlimits 0 requeues 0)
  Sent software 0 bytes 0 pkt
  Sent hardware 0 bytes 10000 pkt
  backlog 0b 0p requeues 0
  used_hw_stats immediate

  action order 2: gact action goto chain 8100000
  random type none pass val 0
  index 2 ref 1 bind 1 installed 6 sec used 6 sec
  Action statistics:
  Sent 0 bytes 10000 pkt (dropped 0, overlimits 0 requeues 0)
  Sent software 0 bytes 0 pkt
  Sent hardware 0 bytes 10000 pkt
  backlog 0b 0p requeues 0
  used_hw_stats immediate</pre>
</div>
</div>
<div class="paragraph">
<p>First comes information about the filter, then the match and finally the actions including statistics.</p>
</div>
<div class="paragraph">
<p>The number of frames that has his the filter is shown as <code>Sent hardware 0 bytes 10000 pkt</code>.</p>
</div>
<div class="paragraph">
<p>Note that the hardware does not support counting the number of bytes and frames dropped by a policer when using IS2.</p>
</div>
<div class="paragraph">
<p>In the current kernel the same statistics are shown for all actions in a filter. This might change in the future.</p>
</div>
<div class="paragraph">
<p>The example above also includes a rule in LAN966x IS1, chain 1200000, with a single action <code>goto chain 8000002</code>.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  This page was built using <a href="https://antora.org">Antora</a>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
